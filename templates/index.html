<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Input</title>
</head>
<body>
    <input type="number" class="columnCreate" placeholder="Kolom" onchange="CreateColumn(this.value, document.getElementById('baris').value)" id="kolom" value="1"/>
    <input type="number" class="columnCreate" placeholder="Baris" onchange="CreateColumn(document.getElementById('kolom').value, this.value)" id="baris" value="1"/>       
    <form id="myForm">
        <div class="input" id="tempatInput">

        </div>
        <button type="button" onclick="submitForm()">Kirim</button>
    </form>

    <script>
        function httpRequest(dataToSend){
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/process_data', true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.onload = function () {
                if (xhr.status === 200) {
                    var response = JSON.parse(xhr.responseText);
                    displayResult(response.result);
                }
            };
            xhr.send(JSON.stringify({ data: dataToSend }));
        }

        function submitForm() {
            var inputs = document.querySelectorAll('.inputArray');
            var totalColumn= document.getElementById('kolom').value;
            var dataArray = [];
    
            inputs.forEach(function(input) {
                dataArray.push(input.value);
            });
    
            console.log(dataArray);
    
            var reshapedArray = reshapeArray(dataArray,totalColumn);
            console.log(reshapedArray);
        }
    
        // Fungsi untuk mengatur ulang struktur array
        function reshapeArray(arr, cols) {
            var newArr = [];
            for (var i = 0; i < arr.length; i += cols) {
                newArr.push(arr.slice(i, i + cols));
            }
            return newArr;
        }

        function perulanganKolom(count,wadah){
            for (var i = 0; i < count; i++) {

            var organDalam = document.createElement("input");
            organDalam.setAttribute("type", "number");
            organDalam.setAttribute("name", "inputArray");
            organDalam.setAttribute("class", "inputArray");
            organDalam.setAttribute("value", "1");
            organDalam.setAttribute("id", "input");
            wadah.appendChild(organDalam);
            }
        }

        function perulaganBaris (countKolom,countBaris,wadah) {  
            for (var i = 0; i < countBaris; i++) {
                var spasi = document.createElement("br");
                perulanganKolom(countKolom,wadah);
                wadah.appendChild(spasi)
            }           
        }

        function CreateColumn(columnCount,rowCount) {
            
            deleteElementsById('containerUntukInput')
            var kulit = document.getElementById('tempatInput');

            var daging = document.createElement("div")
            daging.setAttribute("name", "containerUntukInput");
            daging.setAttribute("id", "containerUntukInput");
            kulit.appendChild(daging)

            perulaganBaris(columnCount,rowCount,daging);
        }
        function deleteElementsById(inputName) {
            var inputElements = document.getElementsByName(inputName);
            console.log(inputElements)
            // Menghapus semua elemen dengan atribut name yang sesuai
            for (var i = 0; i < inputElements.length; i++) {
                var parentElement = inputElements[i].parentNode;
                parentElement.removeChild(inputElements[i]);
            }
        }
    </script>
    
</body>
</html>
